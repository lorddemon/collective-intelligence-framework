# Introduction #

The DNS-BH project creates and maintains a listing of domains that are known to be used to propagate malware and spyware. This project creates the Bind and Windows zone files required to serve fake replies to localhost for any requests to these, thus preventing many spyware installs and reporting.

http://www.malwaredomains.com/

# Details #
## Converting to IODEF ##
```
#!/usr/bin/perl -w

use strict;

# sudo cpan -MCPAN -e install 'XML::IODEF::Simple DateTime JSON'
# see: http://tools.ietf.org/html/rfc5070
use XML::IODEF::Simple;
use Data::Dumper;
use DateTime;
use Getopt::Std;

my %opts;
getopts('j',\%opts);
my $json_out = $opts{'j'} || 0;

my @lines = <STDIN>;
my @array;
foreach (@lines){
    next if(/^#/);
    $_ =~ s/^\t//g;
    $_ =~ s/(\n|\r)$//g;
    my @cols = split(/\t/,$_);
    my ($nextvalidataion,$address,$type,$orig_ref,$dt_verified,$dt_orig_added) = @cols;
    my $confidence = 50;
    # these are generally more specific, so we can tag them with a higher confidence
    $confidence = 85 if($type =~ /(tdl|TDL3|TDL4|tdl3\/tdss|tld4|tld3|rbn)/);
    $confidence = 95 if($orig_ref =~ /sbl\.lasso/);

    my $x = XML::IODEF::Simple->new({
        source      => 'malwaredomains.com',
        IncidentID  => {
            restriction => 'public',
            name        => 'malwaredomains.com',
            instance    => 'http://malwaredomains.com/files/domains.txt',
        },
        restriction => 'public',
        reporttime  => $dt_verified,
        detecttime  => $dt_orig_added,
        address     => $address,
        description => $type,
        # how confident are we that the ENTIRE domain is malicious
        # if only parts of it are malicious, that degrades confidence
        confidence  => $confidence,
        impact      => 'malware domain',
        alternativeid               => $orig_ref,
        alternativeid_restriction   => 'public',
    });
    my $xml = $x->out();
    # this is a work-around, need to fix some stuff in XML::IODEF and XML::IODEF::Simple
    $xml =~ s/^<\?xml version="1.0" encoding="UTF-8"\?>\n//;
    $xml =~ s/^<IODEF-Document version="1.0" .*iodef-1.0">//;
    $xml =~ s/<\/IODEF-Document>\n//g;
    push(@array,$xml);
}
my $text = '<?xml version="1.0" encoding="UTF-8"?>'."\n";
$text .= '<IODEF-Document version="1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:ietf:params:xmls:schema:iodef-1.0">'."\n";
$text .= join("\n",@array);
$text .= "\n</IODEF-Document>\n";

#my $iodef = XML::IODEF->new();
#$iodef->in($text);
#warn Dumper($iodef->to_tree());

if($json_out){
    require JSON;
    my $xx = XML::IODEF->new();
    $xx->in($text);
    $text = JSON::to_json($xx->to_tree());
}

print $text;
```